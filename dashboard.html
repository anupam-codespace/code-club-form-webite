<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - BVEC CODE Club</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-black: #000000;
            --primary-white: #ffffff;
            --light-gray: #f8f9fa;
            --dark-gray: #6c757d;
            --border-gray: #dee2e6;
        }
        
        body {
            font-family: 'Arial', sans-serif;
        }
        
        .sidebar {
            min-height: 100vh;
            background: var(--primary-black);
            color: var(--primary-white);
            border-right: 1px solid var(--border-gray);
        }
        
        .sidebar .nav-link {
            color: rgba(255,255,255,0.8);
            padding: 15px 25px;
            margin: 5px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .sidebar .nav-link:hover {
            background: var(--primary-white);
            color: var(--primary-black);
            border: 1px solid var(--border-gray);
        }
        
        .sidebar .nav-link.active {
            background: var(--primary-white);
            color: var(--primary-black);
            border: 1px solid var(--border-gray);
        }
        
        .main-content {
            margin-left: 280px;
            padding: 30px;
            background: var(--light-gray);
            min-height: 100vh;
        }
        
        .card {
            border: 1px solid var(--border-gray);
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin-bottom: 25px;
            background: var(--primary-white);
        }
        
        .card-header {
            background: var(--primary-black);
            color: var(--primary-white);
            border-radius: 12px 12px 0 0 !important;
            border: none;
            padding: 20px 25px;
        }
        
        .btn-primary {
            background: var(--primary-black);
            border: 1px solid var(--primary-black);
            color: var(--primary-white);
            padding: 12px 25px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: var(--primary-white);
            color: var(--primary-black);
            border: 1px solid var(--primary-black);
        }
        
        .btn-outline-primary {
            background: transparent;
            border: 1px solid var(--primary-black);
            color: var(--primary-black);
            padding: 10px 20px;
            border-radius: 8px;
        }
        
        .btn-outline-primary:hover {
            background: var(--primary-black);
            color: var(--primary-white);
        }
        
        .stats-card {
            text-align: center;
            padding: 30px 20px;
            border: 1px solid var(--border-gray);
            background: var(--primary-white);
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            border-color: var(--primary-black);
            transform: translateY(-2px);
        }
        
        .stats-icon {
            font-size: 2.5rem;
            color: var(--primary-black);
            margin-bottom: 15px;
        }
        
        .stats-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-black);
            margin: 10px 0;
        }
        
        .stats-label {
            color: var(--dark-gray);
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
        }
        
        .form-control {
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 12px 15px;
            color: var(--primary-black);
        }
        
        .form-control:focus {
            border-color: var(--primary-black);
            box-shadow: 0 0 0 0.2rem rgba(0,0,0,0.1);
        }
        
        .table {
            color: var(--primary-black);
        }
        
        .table th {
            background: var(--light-gray);
            color: var(--primary-black);
            border-color: var(--border-gray);
            font-weight: 600;
        }
        
        .table td {
            border-color: var(--border-gray);
        }
        
        .activity-item {
            padding: 15px;
            border-bottom: 1px solid var(--border-gray);
            transition: background-color 0.3s ease;
        }
        
        .activity-item:hover {
            background: var(--light-gray);
        }
        
        .activity-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-black);
            color: var(--primary-white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                margin-left: 0;
                padding: 20px 15px;
            }
        }
        
        [data-bs-theme="dark"] {
            --primary-black: #ffffff;
            --primary-white: #000000;
            --light-gray: #1a1a1a;
            --border-gray: #404040;
        }
        
        [data-bs-theme="dark"] body {
            background: #000000;
            color: #ffffff;
        }
        
        [data-bs-theme="dark"] .main-content {
            background: #111111;
        }
        
        [data-bs-theme="dark"] .card {
            background: #1a1a1a;
            border-color: #404040;
        }
        
        [data-bs-theme="dark"] .table {
            color: #ffffff;
        }
        
        [data-bs-theme="dark"] .table th {
            background: #2a2a2a;
            color: #ffffff;
        }
        
        .clean-header {
            background: var(--primary-white);
            border-bottom: 2px solid var(--primary-black);
            padding: 25px 0;
            margin-bottom: 30px;
        }
        
        .page-title {
            font-size: 2.5rem;
            font-weight: 300;
            color: var(--primary-black);
            margin: 0;
        }
        
        .superform-notice {
            background: var(--light-gray);
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <nav class="sidebar position-fixed top-0 start-0" style="width: 280px;">
        <div class="d-flex flex-column h-100">
            <div class="p-4 border-bottom border-secondary">
                <h4 class="text-center mb-2">
                    <i class="fas fa-code me-2"></i>BVEC CODE Club
                </h4>
                <p class="text-center small opacity-75 mb-0">Admin Panel</p>
            </div>
            
            <ul class="nav nav-pills flex-column flex-grow-1 py-3">
                <li class="nav-item">
                    <a class="nav-link active" href="#" onclick="showSection('dashboard')">
                        <i class="fas fa-tachometer-alt me-3"></i>Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="createForm()">
                        <i class="fas fa-plus-circle me-3"></i>Create Form
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="showSection('submissions')">
                        <i class="fas fa-inbox me-3"></i>Submissions
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="showSection('activity')">
                        <i class="fas fa-chart-line me-3"></i>Activity Log
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="showSection('analytics')">
                        <i class="fas fa-analytics me-3"></i>Analytics
                    </a>
                </li>
            </ul>
            
            <div class="p-3 border-top border-secondary">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <span class="small">Theme Mode</span>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="themeToggle">
                        <label class="form-check-label" for="themeToggle">
                            <i class="fas fa-adjust"></i>
                        </label>
                    </div>
                </div>
                <button class="btn btn-outline-light btn-sm w-100" onclick="logout()">
                    <i class="fas fa-sign-out-alt me-2"></i>Logout
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <div id="dashboard-section" class="section">
            <div class="clean-header">
                <div class="d-flex justify-content-between align-items-center">
                    <h1 class="page-title">Dashboard Overview</h1>
                    <div class="text-end">
                        <small class="text-muted">Admin: <strong id="currentUser"></strong></small><br>
                        <small class="text-muted" id="currentDateTime"></small>
                    </div>
                </div>
            </div>
            
            <!-- Stats Cards -->
            <div class="row mb-4">
                <div class="col-md-3 mb-4">
                    <div class="card stats-card">
                        <i class="fas fa-wpforms stats-icon"></i>
                        <div class="stats-number" id="totalForms">0</div>
                        <div class="stats-label">Total Forms</div>
                    </div>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="card stats-card">
                        <i class="fas fa-paper-plane stats-icon"></i>
                        <div class="stats-number" id="totalSubmissions">0</div>
                        <div class="stats-label">Submissions</div>
                    </div>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="card stats-card">
                        <i class="fas fa-eye stats-icon"></i>
                        <div class="stats-number" id="totalViews">0</div>
                        <div class="stats-label">Form Views</div>
                    </div>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="card stats-card">
                        <i class="fas fa-calendar stats-icon"></i>
                        <div class="stats-number" id="monthlySubmissions">0</div>
                        <div class="stats-label">This Month</div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-bolt me-2"></i>Quick Actions</h5>
                        </div>
                        <div class="card-body p-4">
                            <div class="superform-notice mb-4">
                                <div class="d-flex align-items-center mb-3">
                                    <i class="fas fa-external-link-alt me-2"></i>
                                    <strong>Form Creation via Superform</strong>
                                </div>
                                <p class="mb-3 text-muted">Create professional forms using Superform's advanced editor. Your form data will automatically sync to this dashboard.</p>
                                <button class="btn btn-primary me-3" onclick="createForm()">
                                    <i class="fas fa-plus me-2"></i>Create New Form
                                </button>
                                <small class="text-muted">Opens Superform editor in new tab</small>
                            </div>
                            
                            <div class="d-grid gap-2 d-md-block">
                                <button class="btn btn-outline-primary" onclick="showSection('submissions')">
                                    <i class="fas fa-inbox me-2"></i>View All Submissions
                                </button>
                                <button class="btn btn-outline-primary" onclick="exportData()">
                                    <i class="fas fa-download me-2"></i>Export Data
                                </button>
                                <button class="btn btn-outline-primary" onclick="refreshData()">
                                    <i class="fas fa-sync me-2"></i>Refresh Data
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-clock me-2"></i>Recent Activity</h5>
                        </div>
                        <div class="card-body p-0" id="recentActivity">
                            <div class="activity-item">
                                <div class="d-flex align-items-center">
                                    <div class="activity-icon">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <div>
                                        <div class="fw-bold">Admin logged in</div>
                                        <small class="text-muted">Just now</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Submissions Section -->
        <div id="submissions-section" class="section d-none">
            <div class="clean-header">
                <div class="d-flex justify-content-between align-items-center">
                    <h1 class="page-title">Form Submissions</h1>
                    <button class="btn btn-primary" onclick="refreshSubmissions()">
                        <i class="fas fa-sync me-2"></i>Refresh Data
                    </button>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-table me-2"></i>Submissions Overview</h5>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead>
                                <tr>
                                    <th class="px-4 py-3">Form Name</th>
                                    <th class="px-4 py-3">Submitted By</th>
                                    <th class="px-4 py-3">Email</th>
                                    <th class="px-4 py-3">Date & Time</th>
                                    <th class="px-4 py-3">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="submissionsTable">
                                <tr>
                                    <td colspan="5" class="text-center py-5 text-muted">
                                        <i class="fas fa-inbox fa-2x mb-3 opacity-50"></i><br>
                                        No submissions received yet
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Activity Section -->
        <div id="activity-section" class="section d-none">
            <div class="clean-header">
                <h1 class="page-title">Activity Log</h1>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-history me-2"></i>System Activity Timeline</h5>
                </div>
                <div class="card-body p-0" id="activityTimeline">
                    <div class="activity-item">
                        <div class="d-flex align-items-center">
                            <div class="activity-icon">
                                <i class="fas fa-sign-in-alt"></i>
                            </div>
                            <div>
                                <div class="fw-bold">Admin session started</div>
                                <small class="text-muted">Just now</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Section -->
        <div id="analytics-section" class="section d-none">
            <div class="clean-header">
                <h1 class="page-title">Analytics & Reports</h1>
            </div>
            
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Submission Trends</h5>
                        </div>
                        <div class="card-body text-center py-5">
                            <i class="fas fa-chart-line fa-3x text-muted mb-3"></i>
                            <p class="text-muted">Analytics data will appear here once you start receiving form submissions.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-pie-chart me-2"></i>Form Performance</h5>
                        </div>
                        <div class="card-body text-center py-5">
                            <i class="fas fa-chart-pie fa-3x text-muted mb-3"></i>
                            <p class="text-muted">Performance metrics will be displayed here based on form usage.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Check authentication
        if (!sessionStorage.getItem('adminLoggedIn')) {
            window.location.href = 'index.html';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('currentUser').textContent = sessionStorage.getItem('membershipId');
            updateDateTime();
            loadDashboardData();
            loadRecentActivity();
            
            // Update time every minute
            setInterval(updateDateTime, 60000);
            
            // Theme toggle
            const themeToggle = document.getElementById('themeToggle');
            const currentTheme = localStorage.getItem('theme') || 'light';
            
            if (currentTheme === 'dark') {
                themeToggle.checked = true;
                document.documentElement.setAttribute('data-bs-theme', 'dark');
            }
            
            themeToggle.addEventListener('change', function() {
                const theme = this.checked ? 'dark' : 'light';
                document.documentElement.setAttribute('data-bs-theme', theme);
                localStorage.setItem('theme', theme);
                addActivity(`Switched to ${theme} mode`);
            });
        });

        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit'
            };
            document.getElementById('currentDateTime').textContent = now.toLocaleDateString('en-US', options);
        }

        // Navigation
        function showSection(sectionName) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('d-none');
            });
            
            document.getElementById(sectionName + '-section').classList.remove('d-none');
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            event.target.classList.add('active');
            addActivity(`Viewed ${sectionName} section`);
        }

        // Create Form - Redirect to Superform
        function createForm() {
            addActivity('Opened Superform to create new form');
            window.open('https://superform.co/forms/7rjFDb4/edit', '_blank');
        }

        // Logout
        function logout() {
            addActivity('Admin logged out');
            sessionStorage.clear();
            window.location.href = 'index.html';
        }

        function loadDashboardData() {
            // Load mock data or connect to your actual data source
            const submissions = JSON.parse(localStorage.getItem('formSubmissions') || '[]');
            
            document.getElementById('totalForms').textContent = '1'; // Superform count
            document.getElementById('totalSubmissions').textContent = submissions.length;
            document.getElementById('totalViews').textContent = submissions.length * 2; // Mock view data
            
            const thisMonth = submissions.filter(sub => {
                const subDate = new Date(sub.submitted);
                const now = new Date();
                return subDate.getMonth() === now.getMonth() && subDate.getFullYear() === now.getFullYear();
            });
            document.getElementById('monthlySubmissions').textContent = thisMonth.length;
        }

        function loadRecentActivity() {
            const activities = JSON.parse(localStorage.getItem('activities') || '[]');
            const recentActivityDiv = document.getElementById('recentActivity');
            
            if (activities.length === 0) {
                recentActivityDiv.innerHTML = `
                    <div class="activity-item">
                        <div class="d-flex align-items-center">
                            <div class="activity-icon">
                                <i class="fas fa-info"></i>
                            </div>
                            <div>
                                <div class="text-muted">No recent activity</div>
                                <small class="text-muted">Activities will appear here</small>
                            </div>
                        </div>
                    </div>`;
                return;
            }
            
            let html = '';
            activities.slice(0, 5).forEach(activity => {
                const timeAgo = getTimeAgo(new Date(activity.timestamp));
                html += `
                    <div class="activity-item">
                        <div class="d-flex align-items-center">
                            <div class="activity-icon">
                                <i class="fas fa-activity"></i>
                            </div>
                            <div>
                                <div class="fw-bold">${activity.activity}</div>
                                <small class="text-muted">${timeAgo}</small>
                            </div>
                        </div>
                    </div>`;
            });
            
            recentActivityDiv.innerHTML = html;
            
            // For activity timeline
            const activityTimeline = document.getElementById('activityTimeline');
            if (activityTimeline) {
                let timelineHtml = '';
                activities.forEach(activity => {
                    const timeAgo = getTimeAgo(new Date(activity.timestamp));
                    timelineHtml += `
                        <div class="activity-item">
                            <div class="d-flex align-items-center">
                                <div class="activity-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div>
                                    <div class="fw-bold">${activity.activity}</div>
                                    <small class="text-muted">${timeAgo} by ${activity.user}</small>
                                </div>
                            </div>
                        </div>`;
                });
                activityTimeline.innerHTML = timelineHtml;
            }
        }

        function refreshSubmissions() {
            loadSubmissions();
            addActivity('Refreshed submissions data');
        }

        function loadSubmissions() {
            // This would connect to your Superform webhook data or API
            const submissions = JSON.parse(localStorage.getItem('formSubmissions') || '[]');
            const tbody = document.getElementById('submissionsTable');
            
            if (submissions.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="text-center py-5 text-muted">
                            <i class="fas fa-inbox fa-2x mb-3 opacity-50"></i><br>
                            No submissions received yet<br>
                            <small>Data from Superform will appear here automatically</small>
                        </td>
                    </tr>`;
                return;
            }
            
            let html = '';
            submissions.forEach(submission => {
                html += `
                    <tr>
                        <td class="px-4 py-3">
                            <div class="fw-bold">BVEC Form</div>
                            <small class="text-muted">via Superform</small>
                        </td>
                        <td class="px-4 py-3">${submission.data.name || 'Anonymous'}</td>
                        <td class="px-4 py-3">${submission.data.email || 'N/A'}</td>
                        <td class="px-4 py-3">
                            <div>${new Date(submission.submitted).toLocaleDateString()}</div>
                            <small class="text-muted">${new Date(submission.submitted).toLocaleTimeString()}</small>
                        </td>
                        <td class="px-4 py-3">
                            <button class="btn btn-sm btn-outline-primary" onclick="viewSubmission('${submission.id}')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>`;
            });
            
            tbody.innerHTML = html;
        }

        function viewSubmission(submissionId) {
            const submissions = JSON.parse(localStorage.getItem('formSubmissions') || '[]');
            const submission = submissions.find(sub => sub.id === submissionId);
            
            if (submission) {
                let details = 'Form Submission Details:\n\n';
                for (const [key, value] of Object.entries(submission.data)) {
                    details += `${key}: ${value}\n`;
                }
                details += `\nSubmitted: ${new Date(submission.submitted).toLocaleString()}`;
                
                alert(details);
                addActivity('Viewed submission details');
            }
        }

        function exportData() {
            const submissions = JSON.parse(localStorage.getItem('formSubmissions') || '[]');
            
            if (submissions.length === 0) {
                alert('No data to export');
                return;
            }
            
            // Convert to CSV
            let csv = 'Submitted Date,Submitted Time';
            if (submissions.length > 0) {
                const firstSubmission = submissions[0];
                for (const key in firstSubmission.data) {
                    csv += ',' + key;
                }
                csv += '\n';
            }
            
            submissions.forEach(submission => {
                const date = new Date(submission.submitted);
                let row = `"${date.toLocaleDateString()}","${date.toLocaleTimeString()}"`;
                for (const key in submission.data) {
                    row += ',"' + (submission.data[key] || '').toString().replace(/"/g, '""') + '"';
                }
                csv += row + '\n';
            });
            
            // Download CSV
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'bvec-form-submissions.csv';
            a.click();
            window.URL.revokeObjectURL(url);
            
            addActivity('Exported submissions data to CSV');
        }

        function refreshData() {
            loadDashboardData();
            loadRecentActivity();
            loadSubmissions();
            addActivity('Refreshed all dashboard data');
            
            // Show feedback
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-check me-2"></i>Refreshed';
            setTimeout(() => {
                btn.innerHTML = originalText;
            }, 2000);
        }

        function addActivity(activity) {
            const activities = JSON.parse(localStorage.getItem('activities') || '[]');
            activities.unshift({
                activity: activity,
                timestamp: new Date().toISOString(),
                user: sessionStorage.getItem('membershipId')
            });
            
            // Keep only last 20 activities
            if (activities.length > 20) {
                activities.splice(20);
            }
            
            localStorage.setItem('activities', JSON.stringify(activities));
            loadRecentActivity();
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) return 'Just now';
            if (diffInSeconds < 3600) return Math.floor(diffInSeconds / 60) + ' min ago';
            if (diffInSeconds < 86400) return Math.floor(diffInSeconds / 3600) + ' hrs ago';
            return Math.floor(diffInSeconds / 86400) + ' days ago';
        }

        // Initialize activities on first load
        if (!localStorage.getItem('activities')) {
            addActivity('Admin panel initialized');
        }
        addActivity('Logged into dashboard');
    </script>
</body>
</html>
